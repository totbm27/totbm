// original test path: /Users/curtis/Github/Thesis/chatTester/Repos/sachin-handiekar_jInstagram/src/test/java/org/jinstagram/utils/EnforceSignedRequestUtils_ESTest.java
/*
 * This file was automatically generated by EvoSuite
 * Sat Jan 27 05:11:49 GMT 2024
 */
package org.jinstagram.utils;


import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;
import java.nio.charset.StandardCharsets;
import java.util.Map;
import java.util.*;
import java.lang.*;
import org.junit.Test;
import static org.junit.Assert.*;
import static org.evosuite.runtime.EvoAssertions.*;
import java.util.HashMap;
import org.evosuite.runtime.EvoRunner;
import org.evosuite.runtime.EvoRunnerParameters;
import org.jinstagram.utils.EnforceSignedRequestUtils;
import org.junit.runner.RunWith;

@RunWith(EvoRunner.class)
@EvoRunnerParameters(mockJVMNonDeterminism = true, useVFS = true, useVNET = true, resetStaticState = true, separateClassLoader = false)
public class EnforceSignedRequestUtils_ESTest extends EnforceSignedRequestUtils_ESTest_scaffolding {

    
    @Test
    public void testSignature_withValidInput_returnsExpectedSignature() throws Exception {
        String endpoint = "/v1/users/self/media/recent";
        HashMap<String, String> params = new HashMap<String, String>();
        params.put("count", "10");
        params.put("max_id", "12345");
        params.put("min_id", "54321");
        String clientSecret = "mySecretKey";
        String dataToSign = "/v1/users/self/media/recent|count=10|max_id=12345|min_id=54321";

        Mac mac = Mac.getInstance("HmacSHA256");
        SecretKeySpec keySpec = new SecretKeySpec(clientSecret.getBytes(StandardCharsets.UTF_8), "HmacSHA256");
        mac.init(keySpec);
        byte[] rawHmac = mac.doFinal(dataToSign.getBytes(StandardCharsets.UTF_8));

        StringBuilder sb = new StringBuilder();
        for (byte b : rawHmac) {
            sb.append(String.format("%02x", b & 0xff));
        }
        String expectedSignature = sb.toString();
        String actualSignature = EnforceSignedRequestUtils.signature(endpoint, params, clientSecret);

        assertEquals(expectedSignature, actualSignature);
    }
}
